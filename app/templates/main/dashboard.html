{% extends "base.html" %}

{% from "macros/link_to_tournament.html" import link_to_tournament %}

{% block styles %}
{{ super() }}
<link
        rel="stylesheet"
        href="{{ url_for('static', filename='css/dashboard.css') | autoversion }}"
/>
{% endblock styles %}

{% block content %}

<div class="row">
    <div class="col-sm-6 col-xs-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">{{ _("my_ranking") }}</h3>
            </div>
            <div class="panel-body">
                {% with ranking = current_user.get_current_ranking() %}

                {% if ranking is not none %}
                <div class="row">
                    <div class="col-xs-6 dashboard-column">
                        <p class="dashboard-ranking">#{{ ranking.year_to_date_ranking }}</p>
                    </div>
                    <div class="col-xs-6 dashboard-column dashboard-number-tournaments">
                        <p class="dashboard-text">
                            {% with number_tournaments = ranking.year_to_date_number_tournaments %}
                            {% if number_tournaments == 1 %}
                            {{ _("one_tournament_played_this_year") }}
                            {% else %}
                            {{ _("n_tournaments_played_this_year", n=number_tournaments) }}
                            {% endif %}
                            {% endwith %}
                        </p>
                        <p class="dashboard-text">
                            {{ _("n_points", n=ranking.year_to_date_points) }}
                        </p>
                    </div>
                </div>
                {% else %}
                {{ _("no_tournament_played_this_year") }}
                {% endif %}

                {% endwith %}
            </div>
        </div>
    </div>
    <div class="col-sm-6 col-xs-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">{{ _("ongoing_tournaments") }}</h3>
            </div>
            <div class="panel-body">
                {% with number_ongoing_tournaments = ongoing_tournaments.count() %}

                {% if number_ongoing_tournaments == 1 %}
                <p>{{ _("one_tournament_ongoing") }}</p>
                {% elif number_ongoing_tournaments > 1 %}
                <p>{{ _("n_tournaments_ongoing", n=number_ongoing_tournaments) }}</p>
                {% endif %}

                {% for tournament in ongoing_tournaments %}
                <p>
                    <span class="fa fa-chevron-right"></span>
                    {{ link_to_tournament(tournament) }}
                </p>
                {% endfor %}

                {% endwith %}

                {% with number_open_tournaments = open_tournaments.count() %}

                {% if number_open_tournaments == 1 %}
                <p>{{ _("registrations_are_open_for_one_tournament") }}</p>
                {% elif number_open_tournaments > 1 %}
                <p>{{ _("registrations_are_open_for_the_following_tournaments") }}</p>
                {% endif %}

                {% for tournament in open_tournaments %}
                <p>
                    <span class="fa fa-chevron-right"></span>
                    {{ link_to_tournament(tournament) }}
                    ({{ _("closing") }} {{ tournament.started_at | dt_diff }})
                </p>
                {% endfor %}

                {% endwith %}
            </div>
        </div>
    </div>
</div>

{% endblock content %}
